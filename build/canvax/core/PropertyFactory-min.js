define("canvax/core/PropertyFactory",["canvax/core/Base"],function(a){function b(c,d,f){function g(c,e){(!unwatchOne[c]||unwatchOne[c]&&"$"!==c.charAt(0))&&(d[c]=e);var g=a.getType(e);if("function"===g)unwatchOne[c]||l.push(c);else{if(-1!==_.indexOf(i,c)||"$"===c.charAt(0)&&!f[c])return l.push(c);var m=function(e){var f,i=m.value,k=i;if(!arguments.length)return"object"!==g||i.$model||(i.$parent=j,i=b(i,i),m.value=i),i;var l=a.getType(e);if(!h&&i!==e){"object"===l?(i=e.$model?e:b(e,e),f=i.$model):i=e,m.value=i,d[c]=f?f:i,f||j.$fire&&j.$fire(c,i,k),g!=l&&(g=l);var n=j;if(!j.$watch)for(;n.$parent;)n=n.$parent;n.$watch&&n.$watch.call(n,c,i,k)}};m.value=e,k[c]={set:m,get:m,enumerable:!0}}}var h=!0,i=c.$skipArray,j={},k={},l=_.keys(unwatchOne);d=d||{},f=f||{},i=_.isArray(i)?i.concat(l):l;for(var m in c)g(m,c[m]);return j=e(j,k,l),_.forEach(l,function(a){c[a]&&(j[a]="function"==typeof c[a]?function(){c[a].apply(this,arguments)}:c[a])}),j.$model=d,j.$accessor=k,j.hasOwnProperty=function(a){return a in j.$model},h=!1,j}function c(a,b,c){var d=a[b]&&a[b].set;return 3!==arguments.length?d():(d(c),void 0)}unwatchOne={$skipArray:0,$watch:1,$fire:2,$model:3,$accessor:4,$owner:5,$parent:7};var d=Object.defineProperty;try{d({},"_",{value:"x"});var e=Object.defineProperties}catch(f){"__defineGetter__"in Object&&(d=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},e=function(a,b){for(var c in b)b.hasOwnProperty(c)&&d(a,c,b[c]);return a})}return!e&&window.VBArray&&(window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),e=function(a,b,d){a=d.slice(0),a.push("hasOwnProperty");var e="VBClass"+setTimeout("1"),f={},g=[];g.push("Class "+e,"	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function"),_.forEach(a,function(a){f[a]!==!0&&(f[a]=!0,g.push("	Public ["+a+"]"))});for(var h in b)f[h]=!0,g.push("	Public Property Let ["+h+"](val)",'		Call [__proxy__]([__data__], "'+h+'", val)',"	End Property","	Public Property Set ["+h+"](val)",'		Call [__proxy__]([__data__], "'+h+'", val)',"	End Property","	Public Property Get ["+h+"]","	On Error Resume Next","		Set["+h+'] = [__proxy__]([__data__],"'+h+'")',"	If Err.Number <> 0 Then","		["+h+'] = [__proxy__]([__data__],"'+h+'")',"	End If","	On Error Goto 0","	End Property");return g.push("End Class"),g.push("Function "+e+"Factory(a, b)","	Dim o","	Set o = (New "+e+")(a, b)","	Set "+e+"Factory = o","End Function"),window.parseVB(g.join("\r\n")),window[e+"Factory"](b,c)}),window.PropertyFactory=b,b});